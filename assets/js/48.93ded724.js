(window.webpackJsonp=window.webpackJsonp||[]).push([[48,51],{56:function(t,e,o){},59:function(t,e,o){"use strict";o.d(e,"a",(function(){return a}));var a={DEFAULT:"mapbox://styles/huanglii/ck1n985b20oan1cmhp4i0o9c9?optimize=true",SATELLITE:"mapbox://styles/mapbox/satellite-v9",DARK:"mapbox://styles/huanglii/ck1ocwsbl1fja1cloy67tyefi?optimize=true",GRAY:"mapbox://styles/huanglii/ck1naxpm00gvj1co6r4pxgxzl?optimize=true",MONOCHROME:"mapbox://styles/huanglii/ck3gplwrs0baz1cpe6mgy8aap?optimize=true",FLUORESCENCE:"mapbox://styles/huanglii/ck23131s00los1cnz1qjms49i?optimize=true",WATERLIGHT:"mapbox://styles/huanglii/cjweb960x1nbn1drxxtuaz9cr?optimize=true"}},61:function(t,e,o){"use strict";var a=o(56);o.n(a).a},62:function(t,e,o){"use strict";o.r(e);o(67),o(68),o(66),o(31);var a=o(76),i=o.n(a),n=o(71),r=o.n(n),s=(o(77),o(73)),c=o(74),l=function(){function t(e){Object(s.a)(this,t),this._className="mapboxgl-ctrl",this._options=Object.assign({},{zoom:1,center:[0,0]},e),this._onClickHome=this._onClickHome.bind(this)}return Object(c.a)(t,[{key:"onAdd",value:function(t){return this._map=t,this._container=p.create("div","".concat(this._className," mapboxgl-ctrl-group")),this._render(),this._container}},{key:"onRemove",value:function(){p.remove(this._container),this._map=void 0}},{key:"_render",value:function(){var t=p.create("button","".concat(this._className,"-icon ").concat(this._className,"-home"),this._container);t.type="button",t.addEventListener("click",this._onClickHome)}},{key:"_onClickHome",value:function(){this._map.easeTo(this._options)}}]),t}(),p={create:function(t,e,o){var a=window.document.createElement(t);return void 0!==e&&(a.className=e),o&&o.appendChild(a),a},remove:function(t){t.parentNode&&t.parentNode.removeChild(t)}},d=o(59),u=(o(78),{name:"base-map",props:{height:{type:Number,default:520},mapOptions:{type:Object},mapClickable:{type:Boolean,default:!0},borderOptions:{type:Object}},data:function(){return{map:null,maploaded:!1,mapDefaultOptions:{container:i()(),style:d.a.DEFAULT,center:[-74.5,40],zoom:6,minZoom:0,maxZoom:22,scrollZoom:!0,pitch:0,bearing:0,antialias:!1},borderDefaultOptions:{layout:{visibility:"none"},paint:{"line-color":"hsl(357, 67%, 60%)","line-opacity":["step",["zoom"],1,10,0],"line-width":["interpolate",["linear"],["zoom"],0,1,22,3]},beforeId:""}}},computed:{mapContainer:function(){return this.mapOptions.container||this.mapDefaultOptions.container}},mounted:function(){var t=Object.assign({},this.mapDefaultOptions,this.mapOptions);this.initMap(t),window.addEventListener("resize",this.resize)},methods:{initMap:function(t){r.a.accessToken="pk.eyJ1IjoiaHVhbmdsaWkiLCJhIjoiY2pzNHBtendwMDZ2ZDQzbnVmZXdtMDlvdiJ9.GSija86yNNR4ssBtFFpx0g",this.map=new r.a.Map(t),this.map.addControl(new r.a.NavigationControl,"top-left");var e=t.center,o=t.zoom,a=t.pitch,i=t.bearing;this.map.addControl(new l({center:e,zoom:o,pitch:a,bearing:i}),"bottom-left"),this.map.addControl(new r.a.FullscreenControl,"top-left"),this.map.on("load",this.handleMapLoaded)},handleMapLoaded:function(t){this.maploaded=!0,this.$emit("load",t.target),this.mapClickable&&this.map.on("click",this.handleMapClick)},handleMapClick:function(t){console.log(t.lngLat);var e=this.map.queryRenderedFeatures(t.point);if(e.length>0){var o=e[0],a=o.layer,i=o.properties;Object.keys(i).length>0&&(new r.a.Popup).setLngLat(t.lngLat).setHTML(this.createPropHtml(a.id,i)).addTo(this.map)}},createPropHtml:function(t,e){return'\n        <div class="title"><b>'.concat(t,'</b></div>\n        <div class="content">\n          ').concat(Object.keys(e).map((function(t){return"".concat("<p><b>".concat(t,": </b>").concat(e[t],"</p>"))})).join(""),"\n        </div>\n      ")},addBorderLayer:function(){var t=Object.assign({},this.borderDefaultOptions,this.borderOptions),e=t.layout,o=t.paint,a=t.beforeId;this.map.addSource("border",{type:"vector",url:"mapbox://huanglii.4nxu8jv0"}),this.map.addLayer({id:"border-2oej0r",source:"border","source-layer":"Border-2oej0r",type:"line",layout:e,paint:o},a||void 0)},resize:function(){this.map.resize()}}}),m=(o(61),o(0)),h=Object(m.a)(u,(function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"map-wrapper"},[e("div",{style:{width:"100%",height:this.height+"px",borderRadius:"6px"},attrs:{id:this.mapContainer}},[this._t("custom")],2),this._v(" "),this.maploaded?this._t("default"):this._e()],2)}),[],!1,null,null,null);e.default=h.exports},661:function(t,e,o){"use strict";o.r(e);var a=o(315),i=o(62),n=o(59),r=o(87),s=o(594),c=o(595),l=o.n(c);var p={components:{baseMap:i.default},data:function(){return{mapOptions:{style:n.a.FLUORESCENCE,center:[106.573193,29.558285],zoom:13.5}}},methods:{handleMapLoaded:function(t){var e=this;t.loadImage(this.$withBase("/images/arrow.png"),(function(o,i){if(o)throw o;t.addImage("arrow",i),Object(a.b)(e.$withBase("/data/track.geojson")).then((function(e){!function(t,e){var o=Object(s.coordAll)(e),a=o.length-1,i=o[0],n=o[a],c=Object(r.point)(i),p={type:"Feature",geometry:{type:"LineString",coordinates:[i]}};t.addSource("track-source",{type:"geojson",data:p}),t.addSource("point-source",{type:"geojson",data:c}),t.addLayer({id:"track-line-layer",type:"line",source:"track-source",paint:{"line-width":10,"line-color":"#3d93fd"},layout:{"line-cap":"round","line-join":"round"}}),t.addLayer({id:"track-line-arrow-layer",type:"symbol",source:"track-source",layout:{"symbol-placement":"line","symbol-spacing":3,"icon-image":"arrow","icon-size":.5},paint:{"icon-opacity":.6}}),t.addLayer({id:"track-point-layer",source:"point-source",type:"symbol",layout:{visibility:"visible","icon-size":.65,"icon-image":"car","icon-rotate":["get","bearing"],"icon-rotation-alignment":"map","icon-allow-overlap":!0,"icon-ignore-placement":!0}}),t.addLayer({id:"point-layer",type:"symbol",source:{type:"geojson",data:Object(r.featureCollection)([Object(r.point)(i,{name:"两路口",icon:"start"}),Object(r.point)(n,{name:"小什字",icon:"end"})])},paint:{"text-color":"#E86C48","text-halo-color":"#FFF","text-halo-width":.3,"text-halo-blur":.3},layout:{"icon-size":.5,"icon-image":["get","icon"],"icon-anchor":"bottom","text-anchor":"bottom","text-size":14}});var d=0;!function e(){var i=o[d];c.geometry.coordinates=i,c.properties.bearing=l()(Object(r.point)(o[d>=a?d-1:d]),Object(r.point)(o[d>=a?d:d+1])),p.geometry.coordinates.push(i),t.getSource("track-source").setData(p),t.getSource("point-source").setData(c),t.easeTo({pitch:30,zoom:17,center:i,bearing:c.properties.bearing}),d<a?requestAnimationFrame(e):(t.setLayoutProperty("track-point-layer","visibility","none"),t.easeTo({pitch:0,zoom:13.5,center:[106.573193,29.558285],bearing:0})),d++}()}(t,e)}))}))}}},d=o(0),u=Object(d.a)(p,(function(){var t=this.$createElement;return(this._self._c||t)("base-map",{attrs:{"map-options":this.mapOptions},on:{load:this.handleMapLoaded}})}),[],!1,null,null,null);e.default=u.exports}}]);