(window.webpackJsonp=window.webpackJsonp||[]).push([[16,51],{180:function(t,e){},184:function(t,e){},489:function(t,e,i){var a=i(30);a(a.S,"Date",{now:function(){return(new Date).getTime()}})},56:function(t,e,i){},59:function(t,e,i){"use strict";i.d(e,"a",(function(){return a}));var a={DEFAULT:"mapbox://styles/huanglii/ck1n985b20oan1cmhp4i0o9c9?optimize=true",SATELLITE:"mapbox://styles/mapbox/satellite-v9",DARK:"mapbox://styles/huanglii/ck1ocwsbl1fja1cloy67tyefi?optimize=true",GRAY:"mapbox://styles/huanglii/ck1naxpm00gvj1co6r4pxgxzl?optimize=true",MONOCHROME:"mapbox://styles/huanglii/ck3gplwrs0baz1cpe6mgy8aap?optimize=true",FLUORESCENCE:"mapbox://styles/huanglii/ck23131s00los1cnz1qjms49i?optimize=true",WATERLIGHT:"mapbox://styles/huanglii/cjweb960x1nbn1drxxtuaz9cr?optimize=true"}},61:function(t,e,i){"use strict";var a=i(56);i.n(a).a},62:function(t,e,i){"use strict";i.r(e);i(67),i(68),i(66),i(31);var a=i(76),n=i.n(a),o=i(71),r=i.n(o),s=(i(77),i(73)),l=i(74),c=function(){function t(e){Object(s.a)(this,t),this._className="mapboxgl-ctrl",this._options=Object.assign({},{zoom:1,center:[0,0]},e),this._onClickHome=this._onClickHome.bind(this)}return Object(l.a)(t,[{key:"onAdd",value:function(t){return this._map=t,this._container=u.create("div","".concat(this._className," mapboxgl-ctrl-group")),this._render(),this._container}},{key:"onRemove",value:function(){u.remove(this._container),this._map=void 0}},{key:"_render",value:function(){var t=u.create("button","".concat(this._className,"-icon ").concat(this._className,"-home"),this._container);t.type="button",t.addEventListener("click",this._onClickHome)}},{key:"_onClickHome",value:function(){this._map.easeTo(this._options)}}]),t}(),u={create:function(t,e,i){var a=window.document.createElement(t);return void 0!==e&&(a.className=e),i&&i.appendChild(a),a},remove:function(t){t.parentNode&&t.parentNode.removeChild(t)}},d=i(59),p=(i(78),{name:"base-map",props:{height:{type:Number,default:520},mapOptions:{type:Object},mapClickable:{type:Boolean,default:!0},borderOptions:{type:Object}},data:function(){return{map:null,maploaded:!1,mapDefaultOptions:{container:n()(),style:d.a.DEFAULT,center:[-74.5,40],zoom:6,minZoom:0,maxZoom:22,scrollZoom:!0,pitch:0,bearing:0,antialias:!1},borderDefaultOptions:{layout:{visibility:"none"},paint:{"line-color":"hsl(357, 67%, 60%)","line-opacity":["step",["zoom"],1,10,0],"line-width":["interpolate",["linear"],["zoom"],0,1,22,3]},beforeId:""}}},computed:{mapContainer:function(){return this.mapOptions.container||this.mapDefaultOptions.container}},mounted:function(){var t=Object.assign({},this.mapDefaultOptions,this.mapOptions);this.initMap(t),window.addEventListener("resize",this.resize)},methods:{initMap:function(t){r.a.accessToken="pk.eyJ1IjoiaHVhbmdsaWkiLCJhIjoiY2pzNHBtendwMDZ2ZDQzbnVmZXdtMDlvdiJ9.GSija86yNNR4ssBtFFpx0g",this.map=new r.a.Map(t),this.map.addControl(new r.a.NavigationControl,"top-left");var e=t.center,i=t.zoom,a=t.pitch,n=t.bearing;this.map.addControl(new c({center:e,zoom:i,pitch:a,bearing:n}),"bottom-left"),this.map.addControl(new r.a.FullscreenControl,"top-left"),this.map.on("load",this.handleMapLoaded)},handleMapLoaded:function(t){this.maploaded=!0,this.$emit("load",t.target),this.mapClickable&&this.map.on("click",this.handleMapClick)},handleMapClick:function(t){console.log(t.lngLat);var e=this.map.queryRenderedFeatures(t.point);if(e.length>0){var i=e[0],a=i.layer,n=i.properties;Object.keys(n).length>0&&(new r.a.Popup).setLngLat(t.lngLat).setHTML(this.createPropHtml(a.id,n)).addTo(this.map)}},createPropHtml:function(t,e){return'\n        <div class="title"><b>'.concat(t,'</b></div>\n        <div class="content">\n          ').concat(Object.keys(e).map((function(t){return"".concat("<p><b>".concat(t,": </b>").concat(e[t],"</p>"))})).join(""),"\n        </div>\n      ")},addBorderLayer:function(){var t=Object.assign({},this.borderDefaultOptions,this.borderOptions),e=t.layout,i=t.paint,a=t.beforeId;this.map.addSource("border",{type:"vector",url:"mapbox://huanglii.4nxu8jv0"}),this.map.addLayer({id:"border-2oej0r",source:"border","source-layer":"Border-2oej0r",type:"line",layout:e,paint:i},a||void 0)},resize:function(){this.map.resize()}}}),h=(i(61),i(0)),m=Object(h.a)(p,(function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"map-wrapper"},[e("div",{style:{width:"100%",height:this.height+"px",borderRadius:"6px"},attrs:{id:this.mapContainer}},[this._t("custom")],2),this._v(" "),this.maploaded?this._t("default"):this._e()],2)}),[],!1,null,null,null);e.default=m.exports},645:function(t,e,i){"use strict";i.r(e);var a=i(62),n=(i(489),i(79)),o=i(485),r=i(57),s=i(58),l=i(348),c=i(172),u=[255,255,255],d=[0,0,1],p=[0,0,1],h=0,m=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(r.a)(this,t);var i=e.color,a=void 0===i?u:i,n=e.intensity,o=void 0===n?1:n,s=e.position,l=void 0===s?p:s;this.id=e.id||"point-".concat(h++),this.color=a,this.intensity=o,this.type="point",this.position=l,this.attenuation=g(e),this.projectedLight=Object.assign({},this)}return Object(s.a)(t,[{key:"getProjectedLight",value:function(t){var e=t.layer,i=this.projectedLight,a=e.context.viewport,n=e.props,o=n.coordinateSystem,r=n.coordinateOrigin,s=Object(l.b)(this.position,{viewport:a,coordinateSystem:o,coordinateOrigin:r,fromCoordinateSystem:a.isGeospatial?c.a.LNGLAT:c.a.CARTESIAN,fromCoordinateOrigin:[0,0,0]});return i.color=this.color,i.intensity=this.intensity,i.position=s,i}}]),t}();function g(t){return"attenuation"in t?t.attenuation:"intensity"in t?[0,0,t.intensity]:d}var f=i(609),y=i(641),v=i(64),b=i(63),L=i(65),w=i(97),C=i(208),O=i(481),x=i(316),j=i(246),T=i(334),_=i(282),k={stroked:!0,filled:!0,extruded:!1,elevationScale:1,wireframe:!1,_normalize:!0,lineWidthUnits:"meters",lineWidthScale:1,lineWidthMinPixels:0,lineWidthMaxPixels:Number.MAX_SAFE_INTEGER,lineJointRounded:!1,lineMiterLimit:4,getPolygon:{type:"accessor",value:function(t){return t.polygon}},getFillColor:{type:"accessor",value:[0,0,0,255]},getLineColor:{type:"accessor",value:[0,0,0,255]},getLineWidth:{type:"accessor",value:1},getElevation:{type:"accessor",value:1e3},material:!0},S=function(t){function e(){return Object(r.a)(this,e),Object(v.a)(this,Object(b.a)(e).apply(this,arguments))}return Object(L.a)(e,t),Object(s.a)(e,[{key:"initializeState",value:function(){this.state={paths:[]},this.props.getLineDashArray&&w.a.removed("getLineDashArray","PathStyleExtension")()}},{key:"updateState",value:function(t){var e=this,i=(t.oldProps,t.props,t.changeFlags),a=i.dataChanged||i.updateTriggersChanged&&(i.updateTriggersChanged.all||i.updateTriggersChanged.getPolygon);if(a&&Array.isArray(i.dataChanged)){var n=this.state.paths.slice(),o=i.dataChanged.map((function(t){return Object(_.a)({data:n,getIndex:function(t){return t.__source.index},dataRange:t,replace:e._getPaths(t)})}));this.setState({paths:n,pathsDiff:o})}else a&&this.setState({paths:this._getPaths(),pathsDiff:null})}},{key:"_getPaths",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=this.props,i=e.data,a=e.getPolygon,n=e.positionFormat,o=e._normalize,r=[],s="XY"===n?2:3,l=t.startRow,c=t.endRow,u=Object(C.a)(i,l,c),d=u.iterable,p=u.objectInfo,h=!0,m=!1,g=void 0;try{for(var f,y=d[Symbol.iterator]();!(h=(f=y.next()).done);h=!0){var v=f.value;p.index++;var b=a(v,p);o&&(b=T.c(b,s));var L=b,w=L.holeIndices,O=b.positions||b;if(w)for(var x=0;x<=w.length;x++){var j=O.subarray(w[x-1]||0,w[x]||O.length);r.push(this.getSubLayerRow({path:j},v,p.index))}else r.push(this.getSubLayerRow({path:O},v,p.index))}}catch(t){m=!0,g=t}finally{try{h||null==y.return||y.return()}finally{if(m)throw g}}return r}},{key:"renderLayers",value:function(){var t=this.props,e=t.data,i=t._dataDiff,a=t.stroked,n=t.filled,o=t.extruded,r=t.wireframe,s=t._normalize,l=t.elevationScale,c=t.transitions,u=t.positionFormat,d=this.props,p=d.lineWidthUnits,h=d.lineWidthScale,m=d.lineWidthMinPixels,g=d.lineWidthMaxPixels,f=d.lineJointRounded,y=d.lineMiterLimit,v=d.lineDashJustified,b=this.props,L=b.getFillColor,w=b.getLineColor,C=b.getLineWidth,O=b.getLineDashArray,T=b.getElevation,_=b.getPolygon,k=b.updateTriggers,S=b.material,P=this.state,z=P.paths,D=P.pathsDiff,E=this.getSubLayerClass("fill",x.a),A=this.getSubLayerClass("stroke",j.a),M=this.shouldRenderSubLayer("fill",z)&&new E({_dataDiff:i,extruded:o,elevationScale:l,filled:n,wireframe:r,_normalize:s,getElevation:T,getFillColor:L,getLineColor:w,material:S,transitions:c},this.getSubLayerProps({id:"fill",updateTriggers:{getPolygon:k.getPolygon,getElevation:k.getElevation,getFillColor:k.getFillColor,getLineColor:k.getLineColor}}),{data:e,positionFormat:u,getPolygon:_});return[!o&&M,!o&&a&&this.shouldRenderSubLayer("stroke",z)&&new A({_dataDiff:D&&function(){return D},widthUnits:p,widthScale:h,widthMinPixels:m,widthMaxPixels:g,rounded:f,miterLimit:y,dashJustified:v,_pathType:"loop",transitions:c&&{getWidth:c.getLineWidth,getColor:c.getLineColor,getPath:c.getPolygon},getColor:this.getSubLayerAccessor(w),getWidth:this.getSubLayerAccessor(C),getDashArray:this.getSubLayerAccessor(O)},this.getSubLayerProps({id:"stroke",updateTriggers:{getWidth:k.getLineWidth,getColor:k.getLineColor,getDashArray:k.getLineDashArray}}),{data:z,positionFormat:u,getPath:function(t){return t.path}}),o&&M]}}]),e}(O.a);S.layerName="PolygonLayer",S.defaultProps=k;var P=i(86),z=function(t){function e(){return Object(r.a)(this,e),Object(v.a)(this,Object(b.a)(e).apply(this,arguments))}return Object(L.a)(e,t),Object(s.a)(e,[{key:"getShaders",value:function(){var t=Object(P.a)(Object(b.a)(e.prototype),"getShaders",this).call(this);return t.inject={"vs:#decl":"uniform float trailLength;\nattribute float instanceTimestamps;\nattribute float instanceNextTimestamps;\nvarying float vTime;\n","vs:#main-end":"vTime = instanceTimestamps + (instanceNextTimestamps - instanceTimestamps) * vPathPosition.y / vPathLength;\n","fs:#decl":"uniform float trailLength;\nuniform float currentTime;\nvarying float vTime;\n","fs:#main-start":"if(vTime > currentTime || vTime < currentTime - trailLength) {\n  discard;\n}\n","fs:DECKGL_FILTER_COLOR":"color.a *= 1.0 - (currentTime - vTime) / trailLength;"},t}},{key:"initializeState",value:function(t){Object(P.a)(Object(b.a)(e.prototype),"initializeState",this).call(this,t),this.getAttributeManager().addInstanced({timestamps:{size:1,accessor:"getTimestamps",shaderAttributes:{instanceTimestamps:{vertexOffset:0},instanceNextTimestamps:{vertexOffset:1}}}})}},{key:"draw",value:function(t){var i=this.props,a=i.trailLength,n=i.currentTime;t.uniforms=Object.assign({},t.uniforms,{trailLength:a,currentTime:n}),Object(P.a)(Object(b.a)(e.prototype),"draw",this).call(this,t)}}]),e}(j.a);z.layerName="TripsLayer",z.defaultProps={trailLength:{type:"number",value:120,min:0},currentTime:{type:"number",value:0,min:0},getTimestamps:{type:"accessor",value:null}};var D="https://uber.osgis.cn/uber-common/deck.gl-data/master/examples/trips/buildings.json",E="https://uber.osgis.cn/uber-common/deck.gl-data/master/examples/trips/trips-v7.json",A=new o.a({color:[255,255,255],intensity:1}),M=new m({color:[255,255,255],intensity:2,position:[-74.05,40.7,8e3]}),N=new f.a({ambientLight:A,pointLight:M}),R={buildingColor:[74,80,87],trailColor0:[253,128,93],trailColor1:[23,184,190],material:new n.PhongMaterial({ambient:.1,diffuse:.6,shininess:32,specularColor:[60,64,70]}),effects:[N]},F={longitude:-74,latitude:40.72,zoom:13,pitch:45,bearing:0},W=[[[-74,40.7],[-74.02,40.7],[-74.02,40.72],[-74,40.72]]];var I={components:{baseMap:a.default},data:function(){return{mapOptions:{style:STYLE.DARK,center:[-74,40.72],zoom:13,pitch:45,bearing:0},canvasId:"trips-canvas"}},methods:{handleMapLoaded:function(t){!function(t,e){var i=D,a=E,n=R,o=new S({id:"ground",data:W,getPolygon:function(t){return t},stroked:!1,getFillColor:[0,0,0,0]}),r=new S({id:"buildings",data:i,extruded:!0,wireframe:!1,opacity:.5,getPolygon:function(t){return t.polygon},getElevation:function(t){return t.height},getFillColor:n.buildingColor,material:n.material}),s=new z({id:"trips",data:a,getPath:function(t){return t.path},getTimestamps:function(t){return t.timestamps},getColor:function(t){return 0===t.vendor?n.trailColor0:n.trailColor1},opacity:.3,widthMinPixels:2,rounded:!0,trailLength:180,currentTime:1,shadowEnabled:!1}),l=new y.a({canvas:e,id:e,width:"100%",height:"100%",style:{postion:"relative",top:"0px"},initialViewState:F,controller:!0,onViewStateChange:function(e){var i=e.viewState;t.jumpTo({center:[i.longitude,i.latitude],zoom:i.zoom,bearing:i.bearing,pitch:i.pitch})},effects:n.effects,layers:[s,o,r]});!function t(){var e=Date.now()/1e3%60/60*1800,i={};Object.assign(i,s.props,{currentTime:e,data:a});var n=[new z(i),o,r];l.setProps({layers:n}),window.requestAnimationFrame(t)}()}(t,this.canvasId)}}},H=i(0),J=Object(H.a)(I,(function(){var t=this.$createElement,e=this._self._c||t;return e("base-map",{attrs:{"map-options":this.mapOptions},on:{load:this.handleMapLoaded}},[e("canvas",{staticStyle:{"z-index":"2"},attrs:{slot:"custom",id:this.canvasId},slot:"custom"})])}),[],!1,null,null,null);e.default=J.exports},79:function(t,e,i){"use strict";i(75)}}]);